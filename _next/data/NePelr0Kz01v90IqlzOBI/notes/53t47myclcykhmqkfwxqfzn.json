{"pageProps":{"note":{"id":"53t47myclcykhmqkfwxqfzn","title":"Mass Spectrometry","desc":"","updated":1750658884381,"created":1750333636458,"custom":{},"fname":"random-markov-field.ideas.mass-spectrometry","type":"note","vault":{"fsPath":".","selfContained":true,"name":"acol-dws"},"contentHash":"5e1169a5b2a43992f8b2aa1778868683","links":[],"anchors":{"how-should-we-include-mass-spectrometry-in-our-random-markov-field-":{"type":"header","text":"How should we include mass spectrometry in our random Markov field ?","value":"how-should-we-include-mass-spectrometry-in-our-random-markov-field-","line":8,"column":0,"depth":1},"use-post-annotation-data":{"type":"header","text":"Use post-annotation data","value":"use-post-annotation-data","line":18,"column":0,"depth":2},"pros":{"type":"header","text":"Pros","value":"pros","line":21,"column":0,"depth":4},"cons":{"type":"header","text":"Cons","value":"cons","line":24,"column":0,"depth":4},"use-mass-spec-data-directly":{"type":"header","text":"Use mass spec data directly","value":"use-mass-spec-data-directly","line":27,"column":0,"depth":2},"artificial-spectra":{"type":"header","text":"Artificial spectra","value":"artificial-spectra","line":30,"column":0,"depth":3},"pros-1":{"type":"header","text":"Pros","value":"pros-1","line":37,"column":0,"depth":4},"cons-1":{"type":"header","text":"Cons","value":"cons-1","line":41,"column":0,"depth":4},"ms1":{"type":"header","text":"MS1","value":"ms1","line":45,"column":0,"depth":3},"pros-2":{"type":"header","text":"Pros","value":"pros-2","line":52,"column":0,"depth":4},"cons-2":{"type":"header","text":"Cons","value":"cons-2","line":56,"column":0,"depth":4},"questions-for-pma-":{"type":"header","text":"Questions for PMA :","value":"questions-for-pma-","line":63,"column":0,"depth":2}},"children":[],"parent":"8zuroh0fgf2kcnxxgdyqqxw","data":{}},"body":"<h1 id=\"mass-spectrometry\">Mass Spectrometry<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#mass-spectrometry\"></a></h1>\n<h1 id=\"how-should-we-include-mass-spectrometry-in-our-random-markov-field-\">How should we include mass spectrometry in our random Markov field ?<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#how-should-we-include-mass-spectrometry-in-our-random-markov-field-\"></a></h1>\n<p>On the 17th June 2025 we discussed with Dan and PMA some ideas on how we will implement the mass spec data in our model.\nGiven that the LOTUS data is not sufficient to make predictions of occurrences, we need to take mass spec into account.</p>\n<p>The idea is that during the MCMC, the model will propose a set of molecules (a vector of <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span></span> and <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span></span>) and compare it\nwith the data. Then we accept or reject this proposal so on (classic Gibbs sampling and MCMC).</p>\n<p>We thought there are two main approaches to the problem.</p>\n<h2 id=\"use-post-annotation-data\">Use post-annotation data<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#use-post-annotation-data\"></a></h2>\n<p>This would include using MZMine/Sirius annotation pipelines to then have a list of molecules detected in a sample. </p>\n<h4 id=\"pros\">Pros<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#pros\"></a></h4>\n<p>Comparison is easy between the proposal vector and the data</p>\n<h4 id=\"cons\">Cons<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#cons\"></a></h4>\n<p>We rely on other tools that may output wrongly annotated data.</p>\n<h2 id=\"use-mass-spec-data-directly\">Use mass spec data directly<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#use-mass-spec-data-directly\"></a></h2>\n<p>There are many ways we could use mass spec data</p>\n<h3 id=\"artificial-spectra\">Artificial spectra<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#artificial-spectra\"></a></h3>\n<p>We could simulate a mass spectrum given a SMILES and compare it to a mass spec run. For\neach molecule that we have, we could have a similarity score to the closest spectrum in\nthe MS run.\n<img src=\"/acol-dws/./assets/images/IMG_20250619_134804_1.jpg\"></p>\n<h4 id=\"pros-1\">Pros<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#pros-1\"></a></h4>\n<ul>\n<li>There are many tools to simulate a mass spectrum</li>\n<li>There are many tools to calculate the similarity between two spectrums (Cosine, Dreams embedding, Entropy, etc...)</li>\n</ul>\n<h4 id=\"cons-1\">Cons<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#cons-1\"></a></h4>\n<ul>\n<li>The simulation tools are not very good due to the lack of training data.\nThis would result in having some molecules with low probability even-though they are truly there (see ICEBERG-evaluation).</li>\n</ul>\n<h3 id=\"ms1\">MS1<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#ms1\"></a></h3>\n<p>An idea that came to mind was to directly use the MS1 scans of a mass spectrum. This allows to\ndirectly use the high resolution of the machine. The idea is the following: </p>\n<p>For each molecule in LOTUS, calculate its mass with hydrogen adduct. Then calculate the isotopic pattern\nof that molecule. Then check if the two masses are present in the MS run. </p>\n<h4 id=\"pros-2\">Pros<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#pros-2\"></a></h4>\n<ul>\n<li>Use the resolution of mass spec</li>\n<li>Can match to molecules that might not even have an MS2 spectrum (due to Top-N DDA).</li>\n</ul>\n<h4 id=\"cons-2\">Cons<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#cons-2\"></a></h4>\n<ul>\n<li>We can only work with <strong>molecular formulas</strong></li>\n<li>Probably high false positives rate</li>\n<li>Strongly depends on adduct selection</li>\n</ul>\n<p><img src=\"/acol-dws/./assets/images/IMG_20250619_134816.jpg\"></p>\n<h2 id=\"questions-for-pma-\">Questions for PMA :<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#questions-for-pma-\"></a></h2>\n<ul>\n<li>How do we infer the adduct when we have only a mass ?</li>\n<li>Should we benchmark MetFrag ? Can we use MetFrag to benchmark LOTUS-MINES</li>\n</ul>","noteIndex":{"id":"3rbfqqbp7pwbkdcrgc97u7l","title":"Anticipated Chemistry of Life","desc":"","updated":1727785927929,"created":1671985562294,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":".","selfContained":true,"name":"acol-dws"},"contentHash":"f1947bd87c177e8ee5739c542c5dc574","links":[],"anchors":{"welcome-to-the-dendron-of-the-anticipated-chemistry-of-life":{"type":"header","text":"Welcome to the Dendron of the Anticipated Chemistry of Life","value":"welcome-to-the-dendron-of-the-anticipated-chemistry-of-life","line":8,"column":0,"depth":1}},"children":["l03fwlci5f5rdpot3v7oli6","zxc3pre92d542wg70hmdhgl","289i7valu3z4gm4g4lcullo","jljxwgcjy7uwcw3inriqbhd","bt513r0uipm1jyk3bi1mmwu","5ejymrqkm3f3rsmlxegreyp"],"parent":null,"data":{},"body":"\n# Welcome to the Dendron of the Anticipated Chemistry of Life\n\nThis dendron has the purpose to serve as a laboratory notebook for my PhD thesis. It will contain all the notes that I will take during my research as well as some results of the experiments and models that I will develop and test.\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true,"enableSelfContainedVaults":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":true,"vaultSelectionModeOnCreate":"smart","leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2}},"randomNote":{},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":".","selfContained":true,"name":"acol-dws"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"task","dateFormat":"y.MM.dd","addBehavior":"asOwnDomain","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"taskCompleteStatus":["done","x"],"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link"},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":true,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"enableFullHierarchyNoteTitle":false},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Dendron","description":"Personal Knowledge Space"},"github":{"enableEditLink":true,"editLinkText":"Feel free to participate and click here to edit this page on Github !","editBranch":"main","editViewMode":"tree","editRepository":"https://github.com/anticipated-chemistry-of-life/acol-dws"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"search","siteUrl":"https://anticipated-chemistry-of-life.github.io","assetsPrefix":"/acol-dws","siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true}
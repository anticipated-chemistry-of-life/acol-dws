<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="icon" href="/acol-dws/favicon.ico"/><title>Model Validation</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="Personal Knowledge Space"/><meta property="og:title" content="Model Validation"/><meta property="og:description" content="Personal Knowledge Space"/><meta property="og:url" content="https://anticipated-chemistry-of-life.github.io/acol-dws/notes/ufdb3a64xjinl5jopn58g8q/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="3/6/2025"/><meta property="article:modified_time" content="3/7/2025"/><link rel="canonical" href="https://anticipated-chemistry-of-life.github.io/acol-dws/notes/ufdb3a64xjinl5jopn58g8q/"/><meta name="next-head-count" content="14"/><link rel="preload" href="/acol-dws/_next/static/css/ac87c08ac889e2b6.css" as="style"/><link rel="stylesheet" href="/acol-dws/_next/static/css/ac87c08ac889e2b6.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/acol-dws/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/acol-dws/_next/static/chunks/webpack-ab0757c8fea50bd0.js" defer=""></script><script src="/acol-dws/_next/static/chunks/framework-28c999baf2863c3d.js" defer=""></script><script src="/acol-dws/_next/static/chunks/main-480f1ccb9a155805.js" defer=""></script><script src="/acol-dws/_next/static/chunks/pages/_app-dc2cfb64a564b4b3.js" defer=""></script><script src="/acol-dws/_next/static/chunks/935-4dee79e80b8641c6.js" defer=""></script><script src="/acol-dws/_next/static/chunks/6-50972def09142ee2.js" defer=""></script><script src="/acol-dws/_next/static/chunks/pages/notes/%5Bid%5D-78d472fa3b924116.js" defer=""></script><script src="/acol-dws/_next/static/NePelr0Kz01v90IqlzOBI/_buildManifest.js" defer=""></script><script src="/acol-dws/_next/static/NePelr0Kz01v90IqlzOBI/_ssgManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><section class="ant-layout" style="width:100%;min-height:100%"><header class="ant-layout-header" style="position:fixed;isolation:isolate;z-index:1;width:100%;border-bottom:1px solid #d4dadf;height:64px;padding:0 24px 0 2px"><div class="ant-row ant-row-center" style="max-width:992px;justify-content:space-between;margin:0 auto"><div style="display:flex" class="ant-col ant-col-xs-20 ant-col-sm-4"></div><div class="ant-col gutter-row ant-col-xs-0 ant-col-sm-20 ant-col-md-20 ant-col-lg-19"><div class="ant-select ant-select-lg ant-select-auto-complete ant-select-single ant-select-allow-clear ant-select-show-search" style="width:100%"><div class="ant-select-selector"><span class="ant-select-selection-search"><input type="search" autoComplete="off" class="ant-select-selection-search-input" role="combobox" aria-haspopup="listbox" aria-owns="undefined_list" aria-autocomplete="list" aria-controls="undefined_list" aria-activedescendant="undefined_list_0" value=""/></span><span class="ant-select-selection-placeholder">For full text search please use the &#x27;?&#x27; prefix. e.g. ? Onboarding</span></div></div></div><div style="display:none;align-items:center;justify-content:center" class="ant-col ant-col-xs-4 ant-col-sm-4 ant-col-md-0 ant-col-lg-0"><span role="img" aria-label="menu" style="font-size:24px" tabindex="-1" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></div></div></header><section class="ant-layout" style="margin-top:64px;display:flex;flex-direction:row"><div class="site-layout-sidebar" style="flex:0 0 auto;width:calc(max((100% - 992px) / 2, 0px) + 200px);min-width:200px;padding-left:calc((100% - 992px) / 2)"><aside class="ant-layout-sider ant-layout-sider-dark" style="position:fixed;overflow:auto;height:calc(100vh - 64px);background-color:transparent;flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"></div></aside></div><main class="ant-layout-content side-layout-main" style="max-width:1200px;min-width:0;display:block"><div style="padding:0 24px"><div class="main-content" role="main"><div class="ant-row"><div class="ant-col ant-col-24"><div class="ant-row" style="margin-left:-10px;margin-right:-10px"><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-24 ant-col-md-18"><div><h1 id="model-validation">Model Validation<a aria-hidden="true" class="anchor-heading icon-link" href="#model-validation"></a></h1>
<p>Today is the 6th March 2025. With Madleina we finished the implementation of the MRF model are currently running a couple of simulations to see if the model is working as expected.</p>
<h3 id="stattools-dag">stattools DAG<a aria-hidden="true" class="anchor-heading icon-link" href="#stattools-dag"></a></h3>
<p>Currently the model looks like this :
<img src="/acol-dws/./assets/images/20250303_142539.jpg"></p>
<h3 id="model-validation-1">Model validation<a aria-hidden="true" class="anchor-heading icon-link" href="#model-validation-1"></a></h3>
<p>To validate the model we are going to create two fake trees. One tree will consist of pairs of nodes and roots that are independent of each other. We are also going to set all branch length to the same value. The rate parameters <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\mu_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\mu_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> are set to <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.5</mn></mrow><annotation encoding="application/x-tex">0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.5</span></span></span></span></span>. The other tree will consist of only one root with multiple leaves. We will then set all the branch length to same values and set the rate parameters to a arbitrary value. We will then run the model, and calculate the probability of going from the root to the node (for the second tree). This should result in the same values than the rate matrix.
<img src="/acol-dws/./assets/images/20250306_154257.jpg"></p>
<h2 id="questions">Questions<a aria-hidden="true" class="anchor-heading icon-link" href="#questions"></a></h2>
<ul>
<li>What is the 0 in <code>using TypeBinnedBranchLengths = coretools::UnsignedInt8WithMax&#x3C;0>;</code> ? -> It is just some stattools internal thing. </li>
</ul>
<hr>
<strong>Children</strong>
<ol>
<li><a href="/acol-dws/notes/3bibuh7ra24fpdl24qvn5yq">Debug</a></li>
<li><a href="/acol-dws/notes/4b0y1e6odnucg6b7t8i9450">Parameter Estimation</a></li>
</ol></div></div><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-0 ant-col-md-6"><div><div class=""><div class="ant-anchor-wrapper dendron-toc" style="max-height:calc(100vh - 64px);z-index:1"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#stattools-dag" title="stattools DAG">stattools DAG</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#model-validation" title="Model validation">Model validation</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#questions" title="Questions">Questions</a></div></div></div></div></div></div></div></div></div></div></div><div class="ant-divider ant-divider-horizontal" role="separator"></div><footer class="ant-layout-footer" style="padding:0 24px 24px"></footer></main></section></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"ufdb3a64xjinl5jopn58g8q","title":"Model Validation","desc":"","updated":1741355495848,"created":1741273242837,"custom":{},"fname":"random-markov-field.model-validation","type":"note","vault":{"fsPath":".","selfContained":true,"name":"acol-dws"},"contentHash":"781839c3fe92dcd6bb277c94206810a5","links":[],"anchors":{"stattools-dag":{"type":"header","text":"stattools DAG","value":"stattools-dag","line":10,"column":0,"depth":3},"model-validation":{"type":"header","text":"Model validation","value":"model-validation","line":14,"column":0,"depth":3},"questions":{"type":"header","text":"Questions","value":"questions","line":20,"column":0,"depth":2}},"children":["3bibuh7ra24fpdl24qvn5yq","4b0y1e6odnucg6b7t8i9450"],"parent":"289i7valu3z4gm4g4lcullo","data":{}},"body":"\u003ch1 id=\"model-validation\"\u003eModel Validation\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#model-validation\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cp\u003eToday is the 6th March 2025. With Madleina we finished the implementation of the MRF model are currently running a couple of simulations to see if the model is working as expected.\u003c/p\u003e\n\u003ch3 id=\"stattools-dag\"\u003estattools DAG\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#stattools-dag\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eCurrently the model looks like this :\n\u003cimg src=\"/acol-dws/./assets/images/20250303_142539.jpg\"\u003e\u003c/p\u003e\n\u003ch3 id=\"model-validation-1\"\u003eModel validation\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#model-validation-1\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eTo validate the model we are going to create two fake trees. One tree will consist of pairs of nodes and roots that are independent of each other. We are also going to set all branch length to the same value. The rate parameters \u003cspan class=\"math math-inline\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003eμ\u003c/mi\u003e\u003cmn\u003e0\u003c/mn\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mu_0\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eμ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e0\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e and \u003cspan class=\"math math-inline\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003eμ\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mu_1\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eμ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e are set to \u003cspan class=\"math math-inline\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmn\u003e0.5\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e0.5\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0.5\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e. The other tree will consist of only one root with multiple leaves. We will then set all the branch length to same values and set the rate parameters to a arbitrary value. We will then run the model, and calculate the probability of going from the root to the node (for the second tree). This should result in the same values than the rate matrix.\n\u003cimg src=\"/acol-dws/./assets/images/20250306_154257.jpg\"\u003e\u003c/p\u003e\n\u003ch2 id=\"questions\"\u003eQuestions\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#questions\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eWhat is the 0 in \u003ccode\u003eusing TypeBinnedBranchLengths = coretools::UnsignedInt8WithMax\u0026#x3C;0\u003e;\u003c/code\u003e ? -\u003e It is just some stattools internal thing. \u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003cstrong\u003eChildren\u003c/strong\u003e\n\u003col\u003e\n\u003cli\u003e\u003ca href=\"/acol-dws/notes/3bibuh7ra24fpdl24qvn5yq\"\u003eDebug\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/acol-dws/notes/4b0y1e6odnucg6b7t8i9450\"\u003eParameter Estimation\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e","noteIndex":{"id":"3rbfqqbp7pwbkdcrgc97u7l","title":"Anticipated Chemistry of Life","desc":"","updated":1727785927929,"created":1671985562294,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":".","selfContained":true,"name":"acol-dws"},"contentHash":"f1947bd87c177e8ee5739c542c5dc574","links":[],"anchors":{"welcome-to-the-dendron-of-the-anticipated-chemistry-of-life":{"type":"header","text":"Welcome to the Dendron of the Anticipated Chemistry of Life","value":"welcome-to-the-dendron-of-the-anticipated-chemistry-of-life","line":8,"column":0,"depth":1}},"children":["l03fwlci5f5rdpot3v7oli6","zxc3pre92d542wg70hmdhgl","289i7valu3z4gm4g4lcullo","jljxwgcjy7uwcw3inriqbhd","bt513r0uipm1jyk3bi1mmwu","5ejymrqkm3f3rsmlxegreyp"],"parent":null,"data":{},"body":"\n# Welcome to the Dendron of the Anticipated Chemistry of Life\n\nThis dendron has the purpose to serve as a laboratory notebook for my PhD thesis. It will contain all the notes that I will take during my research as well as some results of the experiments and models that I will develop and test.\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true,"enableSelfContainedVaults":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":true,"vaultSelectionModeOnCreate":"smart","leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2}},"randomNote":{},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":".","selfContained":true,"name":"acol-dws"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"task","dateFormat":"y.MM.dd","addBehavior":"asOwnDomain","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"taskCompleteStatus":["done","x"],"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link"},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":true,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"enableFullHierarchyNoteTitle":false},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Dendron","description":"Personal Knowledge Space"},"github":{"enableEditLink":true,"editLinkText":"Feel free to participate and click here to edit this page on Github !","editBranch":"main","editViewMode":"tree","editRepository":"https://github.com/anticipated-chemistry-of-life/acol-dws"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"search","siteUrl":"https://anticipated-chemistry-of-life.github.io","assetsPrefix":"/acol-dws","siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true},"page":"/notes/[id]","query":{"id":"ufdb3a64xjinl5jopn58g8q"},"buildId":"NePelr0Kz01v90IqlzOBI","assetPrefix":"/acol-dws","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>